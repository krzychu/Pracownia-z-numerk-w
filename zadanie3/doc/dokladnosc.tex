\section{Porównanie dokładności metod}Jeśli chodzi o badanie dokładności uzyskanych wyników sprawa nie jest już takprosta. W zależności od tego, jaką struktrę ma macierz, analizowane przez nasalgorytmy mogą zachowawać się różnie. Postanowiliśmy wiec przeprowadzićeksperymenty dla różnych rodzajów macierzy z zakresu wielkośći $[10, 200]$. Przypożądkujemy numer indentyfikującydany typ macierzy, aby uprościć dalsze rozważania. Mianowicie przez kolejne cyfryoznaczamy:\begin{myenumerate}\item macierz wygenerowaną losowo,\item macierz trójkątną,\item macierz Hilberta (jak wiemy jest to macierz źle uwarunkowana),\item macierz z dominującą przekątną,\item macierz, której wyznaczik jest bliski zeru,\item macierz, dla której jeden z minorów jest zerowy,\item macierz trójprzekątniową.\end{myenumerate}Pierwsze przeprowadzone przez nas badanie polegało na wykonaniu rozkładu $QR$obydwiema metodami i obliczeniu dla uzyskanych wyników wartośći wyrażenia:$$\mathrm{F}(QQ^T - I),$$gdzie $\mathrm{F}$ oznacza \textit{normę Frobeniusa} macierzy, którą definujemydla danej macierzy $A=(a_{ij})$ jako:$$F(A)=(\sum_{i=1}^{n} \sum_{j=1}^{n} a_{ij}^2)^\frac{1}{2}.$$Innymi słowy sprawdzamy, w jakim stopniu wyznaczona macierz $Q$ jest ortogonalna. Im większywspółczynnik, tym obliczona macierz jest bardziej oddalona od porządanej. Częściowe wyniki zostały przedstwionew tabeli na rysunku \textbf{5.1}. Pełne dane można znaleźć w katalogu \textit{prog/testy}. Pierwszy wiersz tabeli określa użytą metodę, drugi zaś wielkość macierzy. W pierwszej kolumnie znajdują się identyfikatory poszczególnych typówmacierzy.\begin{figure}[h!tb]\begin{center}\begin{tabular}{|l||c|c|c|c||c|c|c|c|}\hline\multirow{2}{*}{} & \multicolumn{4}{|c||}{\textbf{\textit{GS}}} & \multicolumn{4}{|c|}{\textbf{\textit{HH}}}\\\cline{2-9}&\textbf{10} & \textbf{40} & \textbf{100} & \textbf{190} & \textbf{10} & \textbf{40} & \textbf{100} & \textbf{190} \\\hline\hline\textbf{1} & $0.5824$ & $80.9396$ & $87.5263$ & $97.9383$ & $0.2926$ & $122.4385$ & $1.1238$ & $2.0456$ \\\hline\textbf{2} & $1.0041$ & $5.9157$ & $16.0520$ & $157.3206$ & $0.1491$ & $0.4351$ & $1.1557$ & $2.1509$ \\\hline\textbf{3} & $ 0.3179$ & $4.8791$ & $20.1218$ & $106.4283$ & $0.1105$ & $0.4917$ & $1.1883$ & $2.1245$ \\\hline\textbf{4} & $ 0.2962$ & $5.5866$ & $38.1047$ & $408.4966$ & $0.2899$ & $0.5077$ & $1.1076$ & $2.3334$ \\\hline\textbf{5} & $ 0.3169$ & $17.6216$ & $72.5043$ & $58.2336$ & $0.1160$ & $0.5325$ & $1.2233$ & $2.1119$ \\\hline\textbf{6} & $ 39.8250$ & $35.6775$ & $49.8930$ & $836.6792$ & $0.1480$ & $0.4992$ & $1.1016$ & $2.1021$ \\\hline\textbf{7} & $ 0.3563$ & $660.1143$ & $621.1397$ & $46.6918$ & $0.1622$ & $0.4681$ & $1.1303$ & $2.1675$ \\\hline\end{tabular}\caption{Tabela dla wyrażenia $\mathrm{F}(QQ^T - I)$, jednostka: $10^{14}$.} \end{center}\end{figure}Analizując tę tabelę, można zaobserwować, że wartość badanego wspołczynnika nie zależy od typu macierzy, zależyzaś od jej wielkości. Dotyczy to zarówno algorytmu $HH$ jak i $GS$. Jednocześnie widzimy, że algorytm Householderaw tym przypadku sprawuje się lepiej, niekiedy nawet wartość współczynnika jest dla niego dwa rzędy niższa. Kolejny eksperymet również dotyczy wyznaczania rozkładu $QR$. Tym razem przyjrzymy się dla obydwu metodi danej macierzy $A$ wartości wyrażenia:$$\mathrm{F}(A-QT).$$Tym samym chcemy się przekonać, jak bardzo rozkład $QR$ deformuje macierz wejściową $A$ w przypadku obu alorytmówi która z metod jest mniej dokładna. Częściowe wyniki uzyskane przy wykonywaniu tego zadania znajdują się w tabeli\textbf{5.2}.\begin{figure}[h!tb]\begin{center}\begin{tabular}{|l||c|c|c|c||c|c|c|c|}\hline\multirow{2}{*}{} & \multicolumn{4}{|c||}{\textbf{\textit{GS}}} & \multicolumn{4}{|c|}{\textbf{\textit{HH}}}\\\cline{2-9}&\textbf{10} & \textbf{40} & \textbf{100} & \textbf{190} & \textbf{10} & \textbf{40} & \textbf{100} & \textbf{190} \\\hline\hline\textbf{1} & $0.1013$ & $17.1612$ & $4.6160$ & $16.2619$ & $0.1616$ & $5.6800$ & $2.7392$ & $6.7934$ \\\hline\textbf{2} & $0.0689$ & $0.6461$ & $3.6861$ & $45.8629$ & $0.1253$ & $0.7209$ & $ 2.8090$ & $7.0702$ \\\hline\textbf{3} & $0.0739$ & $0.5330$ & $3.1111$ & $23.2040$ & $0.1268$ & $0.7758$ & $2.7903$ & $7.1237$ \\\hline\textbf{4} & $0.1038$ & $0.8578$ & $6.5664$ & $49.8840$ & $0.1986$ & $0.7444$ & $2.7274$ & $7.3635$ \\\hline\textbf{5} & $0.0764$ & $6.8850$ & $23.1308$ & $13.7058$ & $0.0979$ & $0.7653$ & $2.7367$ & $6.9651$ \\\hline\textbf{6} & $9.9341$ & $5.9521$ & $9.1611$ & $262.4094$ & $0.0850$ & $0.7019$ & $2.7706$ & $6.9461$ \\\hline\textbf{7} & $0.0492$ & $260.6983$ & $31.3226$ & $21.3792$ & $0.1278$ & $0.7038$ & $2.7631$ & $7.1066$ \\\hline\end{tabular}\caption{Tabela dla wyrażenia $\mathrm{F}(A-QT)$, jednostka: $10^{-12}$.} \end{center}\end{figure}Tak jak w poprzednim przypadku, tak i tutaj wartość wyznacznika dla obydwu metod w niewielkim stopniuzależy od typu badanej macierzy, zależy zaś w podobny sposób od wielkośći macierzy. Na tym nie kończąsię zaobserwowane podobieństwa. Ponownie bardziej efektowny okazuje się być algorytm Householdera, przyczym odpowiednie wielkości normy różnią się o jeden bądź dwa rzęd wielkości dla większych macierzy. Skupimysię więc w dalszych rozważaniach na metodzie \textit{HH}.Zajmijmy się teraz porównaniem algorytmu \textit{HH} z \textit{LU} pod względem dokładności wyznaczanie dladanej macierzy $A$ jej odwrotności. W tym celu będziemy obserwować, jak dla każdej z metod przy przyjęciu kolejnychpodanych wcześniej typów macierzy zachowuje się wartość wyrażenia:$$\mathrm{F}(AA^{-1} - I).$$Rysunek \textbf{5.3} przedstawia tabele z częścią wyników przeprowadzonego eksperymentu. POzostałe dane można znaleźć, tak jak dla wcześniejzaprezentowanych tabel w katalogu \textit{prog/tests}.\begin{figure}[h!tb]\begin{center}\begin{tabular}{|l||c|c|c||c|c|c|}\hline\multirow{2}{*}{} & \multicolumn{3}{|c||}{\textbf{\textit{LU}}} & \multicolumn{3}{|c|}{\textbf{\textit{HH}}}\\\cline{2-7}& \textbf{40} & \textbf{100} & \textbf{190} & \textbf{40} & \textbf{100} & \textbf{190} \\\hline\hline\textbf{1} & $0.12 \cdot 10^{-12}$ & $19.79 \cdot 10^{-12}$ & $61.11 \cdot 10^{-12}$ & $0.02 \cdot 10^{-12}$ & $0.58 \cdot 10^{-12}$ & $0.26 \cdot 10^{-12}$ \\\hline\textbf{2} & $2.90 \cdot 10^{-6}$ & $0.84 \cdot 10^{12}$ & $2.60 \cdot 10^{30}$ & $1.32 \cdot 10^{-6}$ & $0.53 \cdot 10^{12} $ & $11.55 \cdot 10^{30}$ \\\hline\textbf{3} & $0.11 \cdot 10^{9}$ & $8.90\cdot 10^{9}$ & $12.94\cdot 10^{9}$ & $0.19\cdot 10^{9}$ & $2.75\cdot 10^{12}$ & $86.71\cdot 10^{12}$ \\\hline\textbf{4} & $2.12 \cdot 10^{-15}$ & $5.96 \cdot 10^{-15}$ & $11.04 \cdot 10^{-15}$ & $9.12 \cdot 10^{-15}$ & $22.94 \cdot 10^{-15}$ & $51.09 \cdot 10^{-15}$ \\\hline\textbf{5} & $0.11 \cdot 10^{-9}$ & $14.27 \cdot 10^{-9}$ & $89.64 \cdot 10^{-9}$ & $0.17 \cdot 10^{-9}$ & $0.47 \cdot 10^{-9}$ & $16.73 \cdot 10^{-9}$ \\\hline\textbf{6} & $34.68$ & $1.69 \cdot 10^{3}$ & $64.62$ & $0.07 \cdot 10^{-12}$ & $0.08 \cdot 10^{-12}$ & $0.46 \cdot 10^{-12}$ \\\hline\textbf{7} & $0.05 \cdot 10^{-12}$ & $0.15 \cdot 10^{-12}$ & $0.14 \cdot 10^{-12}$ & $0.09 \cdot 10^{-12}$ & $0.09 \cdot 10^{-12}$ & $0.14 \cdot 10^{-12}$ \\\hline\end{tabular}\caption{Tabela dla wyrażenia $\mathrm{F}(AA^{-1}-I)$.} \end{center}\end{figure}W tym przypadku widać, w jak dużym stopniu dokładność wyznaczonej macierzy odwrotnej zależy od struktury danej macierzy i od jej rozmiaru. Dla macierzy losowych, z dominującą przekątną,z wyznacznikiem bliskim zeru i trójdiagonalnych uzyskujemy satysfakcjonująće wartośći wyznacznika dla obydwu metod. Są on bowiem rzędo od$10^{-12}$ do $10^{-9}$.Nie możemy tego jednak powiedzieć w przypadku macierzy trójkątnych i macierzy Hilberta. Tutaj wartość wyrażenia sięga nawet $10^{30}$. Uzyskane odwrotnośći są więccałkowicie niepoprawne. Obie metody zachowują się odmiennie dla macierzy z serowym minorem. Metoda \textit{LU} dlaje nam wartość wyznacznika rzędu $10^{2}$, zaś metoda\textit{HH} zacowuje się definitywnie lepiej, generuje bowiem błąd równy około $10^{-13}$. Wynika to z tego, że w metodzie \textit{LU} dzielimy przez wyznacznikiminorów gównych, co powoduje dzielenie przez liczbę bliską zeru. Dokładnośći, z wyjątkiem macierzy z zerowym minorem głównym, są do siebie zbliżone dla obu metod. Możn więc być skłonnym do stwierdzenia, że lepiej jest wybraćalgorytm Householdera, aby uniknąć tak dużych błędów dla macierzy typu \textbf{6}.Ostatnim ekseprymentem, jaki omówimy, polega na porównaniu metody Householdera i metody $LU$ pod względem dokładnośći wyznaczania macierzy odwrotnej,porównując je z wynikami generowanymi przez program \textit{ocave}. Mianowicie, mając daną macierz $A$ przyjrzymy się wartośći wyrażenia:$$\textrm{F}(A^{-1} - Oc),$$gdzie $Oc$ jest macierzą odwrotną generowaną przez wsponiany powyżej program. Tabela przedstawiona na rysunku \textbf{5.4} stanowi prezentację częściowych wyników.\begin{figure}[h!tb]\begin{center}\begin{tabular}{|l||c|c|c||c|c|c|}\hline\multirow{2}{*}{} & \multicolumn{3}{|c||}{\textbf{\textit{LU}}} & \multicolumn{3}{|c|}{\textbf{\textit{HH}}}\\\cline{2-7}& \textbf{40} & \textbf{100} & \textbf{190} & \textbf{40} & \textbf{100} & \textbf{190} \\\hline\hline\textbf{1} & $8.78 \cdot 10^{-15}$ & $0.18 \cdot 10^{-12}$ & $0.31 \cdot 10^{-12}$ & $0.84 \cdot 10^{-15}$ & $6.13 \cdot 10^{-15}$ & $7.53 \cdot 10^{-15}$ \\\hline\textbf{2} & $0.44 \cdot 10^{-9}$ & $0.11 \cdot 10^{15}$ & $3.03 \cdot 10^{32}$ & $0.24 \cdot 10^{-9}$ & $0.10 \cdot 10^{15} $ & $0.71 \cdot 10^{32}$ \\\hline\textbf{3} & $0.10 \cdot 10^{20}$ & $0.43\cdot 10^{20}$ & $0.39\cdot 10^{20}$ & $0.10\cdot 10^{20}$ & $0.42\cdot 10^{20}$ & $1.55\cdot 10^{20}$ \\\hline\textbf{4} & $1.76 \cdot 10^{-18}$ & $1.87 \cdot 10^{-18}$ & $1.84 \cdot 10^{-18}$ & $12.78 \cdot 10^{-18}$ & $11.15 \cdot 10^{-18}$ & $12.39 \cdot 10^{-18}$ \\\hline	\textbf{5} & $1.50 \cdot 10^{-6}$ & $1.75 \cdot 10^{-6}$ & $2.32 \cdot 10^{-9}$ & $0.02 \cdot 10^{-6}$ & $0.32 \cdot 10^{-6}$ & $0.70 \cdot 10^{-9}$ \\\hline\textbf{6} & $98.15$ & $5.25$ & $2.76$ & $1.17 \cdot 10^{-15}$ & $14.74 \cdot 10^{-15}$ & $0.12 \cdot 10^{-12}$ \\\hline\textbf{7} & $1.51 \cdot 10^{-15}$ & $0.12 \cdot 10^{-12}$ & $33.25 \cdot 10^{-12}$ & $1.06 \cdot 10^{-15}$ & $0.56 \cdot 10^{-12}$ & $45.77 \cdot 10^{-12}$ \\\hline\end{tabular}\caption{Tabela dla wyrażenia $\mathrm{F}(A^{-1}-Oc)$.} \end{center}\end{figure}Podobnie jak w poprzednim przypadku, widzimy, że dla typów macierzy identyfikowanych przez liczby \textbf{1}, \textbf{4}, \textbf{5} i \textbf{7}otrzymujemy odwrotności bliskie tym, które geneuje \textit{octave}, zwłaszcza dla macierzy z dominującą przekątną (błąd jest rzędu $10^{-20}$).Katastrofalne wyniki uzyskujemy dla macierzy trójkątnych i Hilberta. Jak można zauważyć, wartość badanego wyrażenia jest w tym przypadku ogromna,uzyskane odwrotnośći są błędne. Różnica między metodami pojawia się ponownie w przypadku macierzy z zerowym minorem głównym. Wyniki te różnią się $10^{12}$-krotnie na kożyść metody Householdera. Możemy stwierdzić więc, że badane przez nas metody nie są idealne i nie radzą sobie z"trudnymi" macierzami. Troszkę efektywniejszą zdaje się być metoda Householdera.  